<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
    <link rel="stylesheet" href="css/trangchu.css">
    <link rel="stylesheet" href="css/bangdiem.css">
    <link rel="stylesheet" href="css/trangchu3.css">
    
    <title>Thông tin sinh viên</title>
</head>
<body>  
    <div id="wrapper">
        <nav class="navbar navbar-default navbar-fixed-top" role="navigation"> 
            <header>
                <div class="navbar-text pull-right">
                    Quỹ lớp: 5.000.000đ
                </div>
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>  
                    </button>
                    <a class="navbar-brand" href="#"><span class="logo">
                        <img src="images/logo2.png" class="img-fluid" style="width:230px; margin:-10px 0px 0px 0px;"></span>
                    </a>  
                </div>
                <div class="collapse navbar-collapse">
                    <div class="search">   
                        <form class="form-inline">
                            <div class="input-group">
                                <input type="search" class="form-control" size="50" style="border-radius:20px 0px 0px 20px;"
                                    placeholder="Bạn muốn tìm kiếm ..." required>
                                <div class="input-group-btn">
                                    <button type="button" class="btn btn-primary" style="border-radius:0px 20px 20px 0px; outline: none;">
                                        <span class="glyphicon glyphicon-search"></span>Tìm kiếm</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </header>
            <div class="collapse navbar-collapse">
                <div id="header-nav">
                    <ul id="nav">
                        <li><a href=""><i class="nav-icon ti-home"></i></a></li>
                        <li><a href="">TRANG CHỦ</a>|</li>
                        <li><a href="thongtinsv.html">THÔNG TIN SINH VIÊN</a>|</li>
                        <li><a href="bangdiem.html">BẢNG ĐIỂM</a></li>
                    </ul>
                    <div class="user-nav">
                        
                        <!-- <i class="user-icon ti-user"></i> -->
                        <ul id="nav">
                            <li>
                            <a href="#" title="Thông báo" class="notification-icon">
                                <i class="fa fa-bell"></i>
                            </a>
                            <div id="notification-box" class="notification-box">
                                <div class="row">
                                    <div class="col-xs-12">
                                        <!-- Nội dung thông báo sẽ xuất hiện ở đây -->
                                        <p>Thông báo từ admin sẽ hiển thị ở đây.</p>
                                    </div>
                                </div>
                            </div>
                        </li>
                            <li class="username"></li>
                        </ul>
                    </div>
                </div>
            </div> 
        </nav>
        <div></div>
        <div id="body-web">
            <div class="page" style="padding-top: 85px;padding-left: 10px; background: rgb(255, 255, 255);">
                <h3><a href="">Trang chủ</a> <span>/</span> Thông Tin Sinh Viên</h3>
            </div>
            <h2>Thông Tin Sinh Viên</h2>
            <table>
                <thead>
                <tr>
                  <th>STT</th>
                  <th>Họ Tên</th>
                  <th>Ngày sinh</th>
                  <th>Mã Sinh Viên</th>
                  <th>Điểm Trung Bình</th>
                  <th>Thay đổi</th>
                </tr>
                </thead>
                <thead class="listAccount">
                </thead>
               </table>
        
        </div>
        <footer class="site-footer">
            <div class="row">
              <div class="col-sm-12 col-md-3">
                  <h6>Giới thiệu</h6>
                  <p>Nhằm giúp các thầy cô giáo và các sinh viên có thể thuận tiện trong việc kiểm tra thông tin, tình hình học tập, thông tin quỹ lớp,... Chúng tôi đã đưa ra trang quản lý lớp học nhằm phục vụ các giảng viên cũng như các sinh viên</p>
              </div>
              <div class="col-xs-12 col-md-3">
                <h6>Hỗ trợ</h6>
                <ul class="footer-links">
                  <li><a href="">Phương thức liên hệ</a></li>
                  <li><a href="">Địa chỉ</a></li>
                  <li><a href="">Chính sách bảo mật</a></li>
                  <li><a href="">Câu hỏi thường gặp</a></li>
                </ul>
              </div>
              <div class="col-xs-12 col-md-3">
                  <h6>Mạng Xã Hội</h6>
                  <ul class="footer-links" style="display: flex;letter-spacing: 50px;">
                    <li><a href="https://www.facebook.com/bk.huy204"><i class="fa-brands fa-facebook"></i></a></li>
                    <li><a href="https://www.instagram.com/bk.huy204/"><i class="fa-brands fa-instagram"></i></a></li>
                    <li><a href="https://www.youtube.com/channel/UCg7ADvDiRQ1w7ek_gRwV0Sw"><i class="fa-brands fa-youtube"></i></a></li>
                    <li><a href="https://www.tiktok.com/@bk.huy204"><i class="fa-brands fa-tiktok"></i></a></li>
                  </ul>
              </div>
              <div class="col-xs-12 col-md-3">
                <h6>Liên Hệ</h6>
                <ul class="footer-links">
                  <li><a href=""><i class="fa-solid fa-location-dot"></i> 175 Tây Sơn - Đống Đa - Hà Nội</a></li>
                  <li><a href=""><i class="fa-solid fa-phone-volume"></i> 0837 607 568</a></li>
                  <li><a href=""><i class="fa-solid fa-envelope"></i> buikhachuy@gmail.com</a></li>
                </ul>
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-md-8 col-sm-6 col-xs-12">
                <p class="copyright-text">Copyright &copy; 2023 <a href="#">64KTPM3</a>.</p>
              </div>
            </div>
        </footer>
    
        <div id="backtop">
            <i class="fa-solid fa-angles-up"></i>
        </div>
        <div class="modal fade" id="myModal" role="dialog">
            <div class="modal-dialog" style="margin-top: 160px;">
              <!-- Modal content-->
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                  <h4 class="modal-title text-center">Thông tin sinh viên</h4>
                </div>
                <div class="modal-body">
                    <label for="name">Name:</label>
                    <input type="text" id="name"><br>
                
                    <label for="email">Email:</label>
                    <input type="text" id="email" disabled><br>
                
                    <label for="password">Password:</label>
                    <input type="password" id="password"><br>
                
                    <label for="studentCode">Student Code:</label>
                    <input type="text" id="studentCode"><br>
                
                    <label for="class">Class:</label>
                    <input type="text" id="class"><br>
                
                    <label for="birthday">Birthday:</label>
                    <input type="text" id="birthday"><br>
                    
                    <label for="birthday">GPA:</label>
                    <input type="text" id="gpa"><br>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-success" data-dismiss="modal" onclick="handleSaveStudentInfo()">Lưu</button>  
                  <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
              </div>
              
            </div>
          </div>
    </div>
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script>
        // js
        const notificationIcon = document.querySelector(".notification-icon");
        const notificationBox = document.getElementById("notification-box");

        const _listAccount = document.querySelector('.listAccount'); 

        let listAccount = localStorage.getItem('listAccount') || '[]';
        listAccount = JSON.parse(listAccount);

        const tableRows = listAccount.map((account, index) => `
            <tr>
                <th>${index + 1}</th>
                <th>${account.name}</th>
                <th>${account.birthday}</th>
                <th>${account.studentCode}</th>
                <th>${account.gpa || 0}</th>
                <th>
                    <button type="button" class="btn btn-info" data-toggle="modal" data-target="#myModal" onClick="handleUpdate('${account.email}')">Sửa</button>
                    <button type="button" class="btn btn-danger" onClick="handleDelete('${account.email}')">Xóa</button>
                </th>
            </tr>
        `).join("");

        _listAccount.innerHTML = tableRows;

        const username = document.querySelector('.user-nav .username');
        let currentAccount = localStorage.getItem('currentAccount') || '{}';
        currentAccount = JSON.parse(currentAccount);

        username.innerText = currentAccount.name || '';

        notificationIcon.addEventListener("click", (event) => {
            if (notificationBox.style.display === "block") {
                notificationBox.style.display = "none";
            } else {
                notificationBox.style.display = "block";
            }
            event.stopPropagation();
        });

        document.addEventListener("click", (event) => {
            if (!notificationIcon.contains(event.target) && !notificationBox.contains(event.target)) {
                notificationBox.style.display = "none";
            }
        });

        const handleSaveStudentInfo = () => {
            const name = document.getElementById("name").value;
            const email = document.getElementById("email").value;
            const password = document.getElementById("password").value;
            const studentCode = document.getElementById("studentCode").value;
            const _class = document.getElementById("class").value;
            const birthday = document.getElementById("birthday").value;
            const gpa = document.getElementById("gpa").value;

            const data = {
                name: name,
                email: email,
                password: password,
                studentCode: studentCode,
                class: _class,
                birthday: birthday,
                gpa: gpa,
            }

            let listAccount = localStorage.getItem('listAccount') || '[]';
            listAccount = JSON.parse(listAccount);

            listAccount = listAccount.map((account) => account.email === data.email ? data : account);
            localStorage.setItem('listAccount', JSON.stringify(listAccount))
            location.reload();
        }

        const handleUpdate = (email) => {
            let listAccount = localStorage.getItem('listAccount') || '[]';
            listAccount = JSON.parse(listAccount);

            const account = listAccount.find(item => item.email === email);
            // Bind data to input fields
            document.getElementById("name").value = account.name;
            document.getElementById("email").value = account.email;
            document.getElementById("password").value = account.password;
            document.getElementById("studentCode").value = account.studentCode;
            document.getElementById("class").value = account.class;
            document.getElementById("birthday").value = account.birthday;
            document.getElementById("gpa").value = account.gpa || 0;
        }

        const handleDelete = (email) => {
            let listAccount = localStorage.getItem('listAccount') || '[]';
            listAccount = JSON.parse(listAccount);

            const _listAccount = listAccount.filter(item => item.email !== email);

            localStorage.setItem('listAccount', JSON.stringify(_listAccount));
            alert(`Xóa thành công user ${email}`);
            location.reload();
        }
    </script>
</body>
</html>
